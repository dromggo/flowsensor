doctype html
html
  head
    title Dashboard
    link(rel="stylesheet", href="/dashboard.css")
    script(src="https://cdn.jsdelivr.net/npm/chart.js")
  body
    h1 Dashboard
    h2 Últimos 20 datos crudos
    .container
      .left
        table
          thead
            tr
              th Consumo (L/min)
              th Device ID
              th Fecha de Creación
          tbody
            each usage in usages
              tr
                td= usage.value
                td= usage.deviceId
                td= usage.createdAt.toISOString().substring(0, 10) + ' ' + consumo.createdAt.toISOString().substring(11, 19)
      .right
        canvas#trendChart(width="400" height="400")
        canvas#hourlyChart(width="400" height="400")
    script.
      const ctx = document.getElementById('trendChart').getContext('2d');
      const trendChart = new Chart(ctx, {
        type: 'line',
        data: {
          labels: !{JSON.stringify(dates)},
          datasets: [{
            label: 'Consumo Diario (L/min)',
            data: !{JSON.stringify(dailyConsumption)},
            backgroundColor: 'rgba(75, 192, 192, 0.2)',
            borderColor: 'rgba(75, 192, 192, 1)',
            borderWidth: 1
          }]
        },
        options: {
          scales: {
            y: {
              beginAtZero: true
            }
          }
        }
      });

      const ctxHourly = document.getElementById('hourlyChart').getContext('2d');
      const hourlyChart = new Chart(ctxHourly, {
        type: 'bar',
        data: {
          labels: Array.from({ length: 24 }, (_, i) => `${i}:00`),
          datasets: [{
            label: 'Consumo Promedio por Hora (L/min)',
            data: !{JSON.stringify(hourlyConsumption)},
            backgroundColor: 'rgba(153, 102, 255, 0.2)',
            borderColor: 'rgba(153, 102, 255, 1)',
            borderWidth: 1
          }]
        },
        options: {
          scales: {
            y: {
              beginAtZero: true
            }
          }
        }
      });